!function(t,e,i){"use strict";function n(t,e,i,n){this.left=Math.round(t),this.top=Math.round(e),this.width=Math.round(i),this.height=Math.round(n),this.right=this.left+this.width,this.bottom=this.top+this.height}function r(t){this.visibilityRate={both:0,horizontal:0,vertical:0},this.occupiedViewport={both:0,horizontal:0,vertical:0},this.maxVisibility={both:0,horizontal:0,vertical:0},this.element=t,this.onScreen=!1,this.frames={window:new n(0,0,0,0),viewport:new n(0,0,0,0),element:new n(0,0,0,0)}}var o=Array.prototype.slice,h={},s={},c=0,u=function(){t.addEventListener("resize",a),t.addEventListener("scroll",a)},l=function(){t.removeEventListener("resize",a),t.removeEventListener("scroll",a)},a=function(){s={top:document.documentElement.clientTop,left:document.documentElement.clientLeft},h=new n(t.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,t.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.innerWidth,t.innerHeight)},f=function(t){var e=t.getBoundingClientRect(),i=e.top+h.top-s.top,r=e.left+h.left-s.left;return new n(r,i,e.width,e.height)},d=function(t,e){if(m(t)){for(var i=!0,n=0,r=t.length;r>n;n++)i&=e(t[n]);return!!i}return e(t)},m=function(t){return t.length!==i};n.prototype.getArea=function(){return this.width*this.height},n.prototype.subtractFrom=function(t){return new n(this.left-t.left,this.top-t.top,this.width,this.height)},n.prototype.intersectionWith=function(t){var e=Math.max(this.top,t.top),i=Math.max(this.left,t.left),r=Math.min(this.right,t.right),o=Math.min(this.bottom,t.bottom),h=r-i,s=o-e;return h>=0&&s>=0?new n(i,e,h,s):null};var g=function(){var e,n=this,s=[],d=!1,m=function(e){var i=e.constructor.name||null;if(s=[],"string"==typeof e&&(s=o.call(document.querySelectorAll(e),0)),t.jQuery&&e instanceof jQuery)s=jQuery.makeArray(e);else if("NodeList"===i)s=o.call(e,0);else if(Array.isArray(e))s=e;else{if(!e.nodeType)return null;s.push(e)}},g=function(){e&&e.call(n,n.getState(s))};n.bind=function(i,n){c++||u(),"function"==typeof n?e=n:console.error("[Visc: Invalid Callback]"),m(i),d=!0,t.addEventListener("resize",g),t.addEventListener("scroll",g)},n.unbind=function(){n.__elements=[],d=!1,t.removeEventListener("resize",g),t.removeEventListener("scroll",g),--c||l()},n.isOnScreen=function(t){return t.left<=h.right&&t.right>=h.left&&t.top<=h.bottom&&t.bottom>=h.top},n.getState=function(t){if(t===i)return null;s.length||m(t),d||a();for(var e=[],o=0;o<s.length;o++){var c=s[o],u=f(c),l=u.intersectionWith(h),g=u.getArea(),v=new r(c);if(l&&0!==u.width&&0!==u.height){var w=l.getArea(),p=Math.min(u.width,h.width),b=Math.min(u.height,h.height);v.frames={window:l,viewport:l.subtractFrom(h),element:l.subtractFrom(u)},v.visibilityRate={both:w/g,horizontal:l.width/u.width,vertical:l.height/u.height},v.occupiedViewport={both:w/h.getArea(),horizontal:l.width/h.width,vertical:l.height/h.height},v.maxVisibility={both:w/(p*b),horizontal:l.width/p,vertical:l.height/b}}v.onScreen=n.isOnScreen(u),e.push(v)}return e},a()};g.getNumberOfInstances=function(){return c},g.getState=function(t){return(new g).getState(t)},g.isVisible=function(t,e){return e=e||0,d(g.getState(t),function(t){var i=t.visibilityRate.both;return i>0&&i>=e})},g.isOnScreen=function(t){return d(t,function(t){return(new g).isOnScreen(f(t))})},e&&(e.fn.visc=function(t){if("getState"===t)return g.getState(this);if("function"==typeof t||!t){var i=new g;return this.data("visc",i),i.bind(this,arguments[0]),this}e.error('Method "'+t+'"" does not exist on $.ViSC')},e.fn.unvisc=function(){return this.data("visc").unbind()}),t.Visc=g}(window,window.jQuery||window.Zepto||window.$);