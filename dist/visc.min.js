!function(t,e,i){"use strict";function n(t,e,i,n){this.left=Math.round(t),this.top=Math.round(e),this.width=Math.round(i),this.height=Math.round(n),this.right=this.left+this.width,this.bottom=this.top+this.height}function o(t){this.visibilityRate={both:0,horizontal:0,vertical:0},this.occupiedViewport={both:0,horizontal:0,vertical:0},this.maxVisibility={both:0,horizontal:0,vertical:0},this.element=t,this.frames={window:new n(0,0,0,0),viewport:new n(0,0,0,0),element:new n(0,0,0,0)}}var r=Array.prototype.slice,h={},s={},l=0,a=function(){t.addEventListener("resize",u),t.addEventListener("scroll",u)},c=function(){t.removeEventListener("resize",u),t.removeEventListener("scroll",u)},u=function(){s={top:document.documentElement.clientTop,left:document.documentElement.clientLeft},h=new n(t.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,t.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.innerWidth,t.innerHeight)};n.prototype.getArea=function(){return this.width*this.height},n.prototype.subtractFrom=function(t){return new n(this.left-t.left,this.top-t.top,this.width,this.height)},n.prototype.intersectionWith=function(t){var e=Math.max(this.top,t.top),i=Math.max(this.left,t.left),o=Math.min(this.right,t.right),r=Math.min(this.bottom,t.bottom),h=o-i,s=r-e;return h>=0&&s>=0?new n(i,e,h,s):null};var d=function(){var e,d=this,f=[],m=!1,w=function(t){var e=t.getBoundingClientRect(),i=e.top+h.top-s.top,o=e.left+h.left-s.left;return new n(o,i,e.width,e.height)},v=function(e){var i=e.constructor.name||null;if(f=[],"string"==typeof e&&(f=r.call(document.querySelectorAll(e),0)),t.jQuery&&e instanceof jQuery)f=jQuery.makeArray(e);else if("NodeList"===i)f=r.call(e,0);else if(Array.isArray(e))f=e;else{if(!e.nodeType)return null;f.push(e)}},p=function(){e&&e.call(d,d.getState(f))};d.bind=function(i,n){l++||a(),"function"==typeof n?e=n:console.error("[Visc: Invalid Callback]"),v(i),m=!0,t.addEventListener("resize",p),t.addEventListener("scroll",p)},d.unbind=function(){d.__elements=[],m=!1,t.removeEventListener("resize",p),t.removeEventListener("scroll",p),--l||c()},d.getState=function(t){if(t===i)return null;f.length||v(t),m||u();for(var e=[],n=0;n<f.length;n++){var r=f[n],s=w(r),l=s.intersectionWith(h),a=new o(r);if(l){var c=l.getArea(),d=Math.min(s.width,h.width),p=Math.min(s.height,h.height);a.frames={window:l,viewport:l.subtractFrom(h),element:l.subtractFrom(s)},a.visibilityRate={both:c/s.getArea(),horizontal:l.width/s.width,vertical:l.height/s.height},a.occupiedViewport={both:c/h.getArea(),horizontal:l.width/h.width,vertical:l.height/h.height},a.maxVisibility={both:c/(d*p),horizontal:l.width/d,vertical:l.height/p}}e.push(a)}return e},u()};d.getNumberOfInstances=function(){return l},d.getState=function(t){return(new d).getState(t)},d.isVisible=function(e,i){return i=i||0,(t.jQuery&&e instanceof jQuery||Array.isArray(e))&&(e=e[0]),e.nodeType?(new d).getState(e)[0].visibilityRate.both>i:null},e&&(e.fn.visc=function(t){if("getState"===t)return d[t].call(this,r(arguments,1));if("function"==typeof t||!t){var i=new d;return this.data("visc",i),i.bind(this,arguments[0]),this}e.error('Method "'+t+'"" does not exist on $.ViSC')},e.fn.unvisc=function(){return this.data("visc").unbind()}),t.Visc=d}(window,window.jQuery||window.Zepto||window.$);