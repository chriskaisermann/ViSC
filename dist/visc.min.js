!function(t,e,i){"use strict";function n(t,e,i,n){this.left=Math.round(t),this.top=Math.round(e),this.width=Math.round(i),this.height=Math.round(n),this.right=this.left+this.width,this.bottom=this.top+this.height}function r(t){this.visibilityRate={both:0,horizontal:0,vertical:0},this.occupiedViewport={both:0,horizontal:0,vertical:0},this.maxVisibility={both:0,horizontal:0,vertical:0},this.element=t,this.onScreen=!1,this.frames={window:new n(0,0,0,0),viewport:new n(0,0,0,0),element:new n(0,0,0,0)}}var o=Array.prototype.slice,h={},s={},c=0,l=function(){t.addEventListener("resize",a),t.addEventListener("scroll",a)},u=function(){t.removeEventListener("resize",a),t.removeEventListener("scroll",a)},a=function(){s={top:document.documentElement.clientTop,left:document.documentElement.clientLeft},h=new n(t.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,t.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.innerWidth,t.innerHeight)},f=function(e){return(t.jQuery&&e instanceof jQuery||Array.isArray(e))&&(e=e[0]),e.nodeType?e:null},d=function(t){var e=t.getBoundingClientRect(),i=e.top+h.top-s.top,r=e.left+h.left-s.left;return new n(r,i,e.width,e.height)};n.prototype.getArea=function(){return this.width*this.height},n.prototype.subtractFrom=function(t){return new n(this.left-t.left,this.top-t.top,this.width,this.height)},n.prototype.intersectionWith=function(t){var e=Math.max(this.top,t.top),i=Math.max(this.left,t.left),r=Math.min(this.right,t.right),o=Math.min(this.bottom,t.bottom),h=r-i,s=o-e;return h>=0&&s>=0?new n(i,e,h,s):null};var m=function(){var e,n=this,s=[],f=!1,m=function(e){var i=e.constructor.name||null;if(s=[],"string"==typeof e&&(s=o.call(document.querySelectorAll(e),0)),t.jQuery&&e instanceof jQuery)s=jQuery.makeArray(e);else if("NodeList"===i)s=o.call(e,0);else if(Array.isArray(e))s=e;else{if(!e.nodeType)return null;s.push(e)}},w=function(){e&&e.call(n,n.getState(s))};n.bind=function(i,n){c++||l(),"function"==typeof n?e=n:console.error("[Visc: Invalid Callback]"),m(i),f=!0,t.addEventListener("resize",w),t.addEventListener("scroll",w)},n.unbind=function(){n.__elements=[],f=!1,t.removeEventListener("resize",w),t.removeEventListener("scroll",w),--c||u()},n.isOnScreen=function(t){return t.left<=h.right&&t.right>=h.left&&t.top<=h.bottom&&t.bottom>=h.top},n.getState=function(t){if(t===i)return null;s.length||m(t),f||a();for(var e=[],o=0;o<s.length;o++){var c=s[o],l=d(c),u=l.intersectionWith(h),w=l.getArea(),g=new r(c);if(u&&0!==l.width&&0!==l.height){var p=u.getArea(),v=Math.min(l.width,h.width),b=Math.min(l.height,h.height);g.frames={window:u,viewport:u.subtractFrom(h),element:u.subtractFrom(l)},g.visibilityRate={both:p/w,horizontal:u.width/l.width,vertical:u.height/l.height},g.occupiedViewport={both:p/h.getArea(),horizontal:u.width/h.width,vertical:u.height/h.height},g.maxVisibility={both:p/(v*b),horizontal:u.width/v,vertical:u.height/b}}g.onScreen=n.isOnScreen(l),e.push(g)}return e},a()};m.getNumberOfInstances=function(){return c},m.getState=function(t){return(new m).getState(t)},m.isVisible=function(t,e){return e=e||0,(new m).getState(f(t))[0].visibilityRate.both>=e},m.isOnScreen=function(t){return(new m).isOnScreen(d(f(t)))},e&&(e.fn.visc=function(t){if("getState"===t)return m.getState(this);if("function"==typeof t||!t){var i=new m;return this.data("visc",i),i.bind(this,arguments[0]),this}e.error('Method "'+t+'"" does not exist on $.ViSC')},e.fn.unvisc=function(){return this.data("visc").unbind()}),t.Visc=m}(window,window.jQuery||window.Zepto||window.$);